# دليل الإعداد الكامل لـ Supabase - جامعة بلانر

## 1. إنشاء مشروع Supabase

### الخطوة 1: إنشاء الحساب
1. اذهب إلى [supabase.com](https://supabase.com)
2. اضغط على "Start your project"
3. سجل الدخول أو أنشئ حساب جديد
4. اضغط على "New Project"

### الخطوة 2: إعداد المشروع
1. اختر منظمة (Organization)
2. أدخل اسم المشروع: `university-planner`
3. أدخل كلمة مرور قوية لقاعدة البيانات
4. اختر المنطقة الأقرب لك
5. اضغط على "Create new project"

## 2. إعداد قاعدة البيانات

### الخطوة 1: تشغيل ملفات SQL
1. اذهب إلى SQL Editor في لوحة التحكم
2. انسخ محتوى `database/schema.sql` والصقه في المحرر
3. اضغط على "Run" لإنشاء الجداول
4. كرر نفس العملية مع `database/policies.sql`
5. كرر نفس العملية مع `database/seed.sql` (اختياري - للبيانات التجريبية)

### الخطوة 2: التحقق من الجداول
1. اذهب إلى Table Editor
2. تأكد من وجود الجداول التالية:
   - `materials`
   - `pdfs`
   - `videos`
   - `users`

## 3. إعداد Storage

### الخطوة 1: إنشاء Bucket
1. اذهب إلى Storage في القائمة الجانبية
2. اضغط على "Create a new bucket"
3. أدخل الاسم: `materials`
4. اختر "Public bucket"
5. اضغط على "Create bucket"

### الخطوة 2: إعداد السياسات
1. اذهب إلى Authentication > Policies
2. تأكد من أن السياسات تم تطبيقها من ملف `database/policies.sql`

## 4. الحصول على المفاتيح

### الخطوة 1: نسخ المفاتيح
1. اذهب إلى Settings > API
2. انسخ `Project URL`
3. انسخ `anon public` key

### الخطوة 2: إعداد متغيرات البيئة
1. أنشئ ملف `.env.local` في جذر المشروع
2. أضف المحتوى التالي:

```env
NEXT_PUBLIC_SUPABASE_URL=your-project-url-here
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

## 5. تشغيل التطبيق

### الخطوة 1: تثبيت التبعيات
```bash
npm install
```

### الخطوة 2: تشغيل التطبيق
```bash
npm run dev
```

### الخطوة 3: فتح التطبيق
افتح [http://localhost:3000](http://localhost:3000) في المتصفح

## 6. اختبار الوظائف

### اختبار الصفحة الرئيسية
1. اختر برنامج (General, Cyber Security, AI)
2. اختر السنة والترم
3. تأكد من ظهور المواد

### اختبار صفحة الإدارة
1. اذهب إلى `/admin`
2. جرب إضافة مادة جديدة
3. جرب رفع ملف PDF
4. جرب إضافة فيديو يوتيوب

### اختبار صفحة المواد
1. اضغط على أي مادة من الصفحة الرئيسية
2. تأكد من ظهور ملفات PDF والفيديوهات

## 7. استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### خطأ: "Invalid API key"
- تأكد من نسخ المفاتيح بشكل صحيح
- تأكد من وجود ملف `.env.local`

#### خطأ: "Table doesn't exist"
- تأكد من تشغيل ملف `schema.sql`
- تحقق من أسماء الجداول في Supabase

#### خطأ: "Permission denied"
- تأكد من تشغيل ملف `policies.sql`
- تحقق من إعدادات RLS

#### خطأ: "Storage bucket not found"
- تأكد من إنشاء bucket باسم `materials`
- تحقق من إعدادات Storage policies

## 8. نصائح مهمة

### الأمان
- لا تشارك مفاتيح API
- استخدم متغيرات البيئة دائماً
- فعّل RLS على جميع الجداول

### الأداء
- استخدم الفهارس لتحسين الاستعلامات
- احذف البيانات غير المستخدمة بانتظام
- راقب استخدام Storage

### الصيانة
- احتفظ بنسخ احتياطية من قاعدة البيانات
- راقب سجلات الأخطاء
- حدث التبعيات بانتظام

## 9. الملفات المهمة

- `src/lib/supabase.ts` - إعداد Supabase
- `src/lib/supabaseService.ts` - خدمات قاعدة البيانات
- `database/schema.sql` - هيكل قاعدة البيانات
- `database/policies.sql` - سياسات الأمان
- `database/seed.sql` - البيانات التجريبية

## 10. الدعم

إذا واجهت أي مشاكل:
1. تحقق من سجلات الأخطاء في المتصفح
2. تحقق من سجلات Supabase
3. راجع هذا الدليل مرة أخرى
4. تأكد من اتباع جميع الخطوات بالترتيب
