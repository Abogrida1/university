# ุฏููู ูุธุงู ุตูุงุญูุงุช ุงูุฃุฏููุฒ ุงููุชูุฏู
# Advanced Admin Permissions System Guide

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅูุดุงุก ูุธุงู ุตูุงุญูุงุช ูุชูุฏู ูุณูุญ ูููุฏูุฑ ุงูุฑุฆูุณู (Super Admin) ุจุฅูุดุงุก ูุฏูุฑูู (Admins) ูุชุญุฏูุฏ ุตูุงุญูุงุช ุฏูููุฉ ููู ูููู ุจูุงุกู ุนูู:
- **ุงููุณู** (Department): ุงูุฃูู ุงูุณูุจุฑุงููุ ุงูุฐูุงุก ุงูุงุตุทูุงุนูุ ุงูุจุฑูุงูุฌ ุงูุนุงูุ ุฃู ุฌููุน ุงูุฃูุณุงู
- **ุงูุณูุฉ ุงูุฏุฑุงุณูุฉ** (Year): 1ุ 2ุ 3ุ 4ุ ุฃู ุฌููุน ุงูุณููุงุช
- **ุงูุชุฑู** (Term): ุงูุฃููุ ุงูุซุงููุ ุฃู ุฌููุน ุงูุชุฑูุงุช
- **ุงูุตูุงุญูุงุช ุงูุชูุตูููุฉ**: ุฅุฏุงุฑุฉ ุงูููุงุฏุ PDFุ ุงูููุฏููุ ุงูุฌุฏุงููุ ุงูุฑุณุงุฆูุ ุงูุฅุญุตุงุฆูุงุชุ ุงููุณุชุฎุฏูููุ ุงูุฃุฏููุฒ

## ุงููููุงุช ุงูุฌุฏูุฏุฉ

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
database/admin-permissions-system.sql
```
- ุฌุฏูู `admin_scopes`: ูุทุงูุงุช ุตูุงุญูุงุช ุงูุฃุฏูู
- ุฌุฏูู `admin_scope_audit`: ุณุฌู ุชุบููุฑุงุช ุงูุตูุงุญูุงุช
- ุฏูุงู SQL ูุณุงุนุฏุฉ ููุชุญูู ูู ุงูุตูุงุญูุงุช

### 2. ุงูุฎุฏูุงุช (Services)
```typescript
src/lib/adminService.ts
```
- ุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ
- ุฅุถุงูุฉ ูุชุนุฏูู ูุญุฐู ูุทุงูุงุช ุงูุตูุงุญูุงุช
- ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุฃุฏูู

```typescript
src/lib/permissionChecker.ts
```
- ูุธุงู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- ุฏูุงู ูุณุงุนุฏุฉ ููุชุญูู ูู ูู ููุน ุตูุงุญูุฉ

### 3. ุงููุงุฌูุงุช (UI)
```typescript
src/app/admin/manage-admins/page.tsx
```
- ูุงุฌูุฉ ุนุตุฑูุฉ ูุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ
- ุฅุถุงูุฉ ุฃุฏููุฒ ุฌุฏุฏ
- ุชุญุฏูุฏ ูุทุงูุงุช ุงูุตูุงุญูุงุช
- ุนุฑุถ ูุชุนุฏูู ุงูุตูุงุญูุงุช

## ุฅุนุฏุงุฏ ุงููุธุงู

### 1. ุชุดุบูู ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
ุงูุชุญ Supabase Dashboard ูุดุบู ุงูููู:
```sql
database/admin-permissions-system.sql
```

ูุฐุง ุณููุดุฆ:
- ุฌุฏูู `admin_scopes`
- ุฌุฏูู `admin_scope_audit`
- ุงูุฏูุงู ุงููุณุงุนุฏุฉ
- ุงูููุงุฑุณ ูุชุญุณูู ุงูุฃุฏุงุก
- Triggers ูุชุณุฌูู ุงูุชุบููุฑุงุช

### 2. ุงูุชุฃูุฏ ูู ูุฌูุฏ Super Admin
ุชุฃูุฏ ูู ูุฌูุฏ ุญุณุงุจ Super Admin ูู ุงููุธุงู:
```sql
-- ุงูุชุญูู ูู ูุฌูุฏ Super Admin
SELECT * FROM users WHERE role = 'super_admin';
```

ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุงุณุชุฎุฏู ุงูุญุณุงุจ ุงูุงูุชุฑุงุถู:
- ุงูุจุฑูุฏ: `admin@university.edu`
- ูููุฉ ุงููุฑูุฑ: `password`

## ุงุณุชุฎุฏุงู ุงููุธุงู

### ูููุฏูุฑ ุงูุฑุฆูุณู (Super Admin)

#### 1. ุงููุตูู ูุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ
1. ุณุฌู ุฏุฎูู ูู Super Admin
2. ุงุฐูุจ ุฅูู Dashboard
3. ุงุถุบุท ุนูู ุชุจููุจ "ุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ ูุงูุตูุงุญูุงุช" ๐
4. ุฃู ุงุฐูุจ ูุจุงุดุฑุฉ ุฅูู: `/admin/manage-admins`

#### 2. ุฅุถุงูุฉ ุฃุฏูู ุฌุฏูุฏ
1. ุงุถุบุท ุนูู "ุฅุถุงูุฉ ุฃุฏูู ุฌุฏูุฏ"
2. ุฃุฏุฎู ุงูุจูุงูุงุช:
   - ุงูุงุณู
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ูุฌุจ ุฃู ูููู ุบูุฑ ุฌุงูุนู)
   - ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)
   - ุงูุฏูุฑ (ุฃุฏูู ุฃู ูุฏูุฑ ุฑุฆูุณู)
3. ุงุถุบุท "ุฅูุดุงุก"

#### 3. ุชุญุฏูุฏ ุตูุงุญูุงุช ุงูุฃุฏูู
ุจุนุฏ ุฅูุดุงุก ุงูุฃุฏูู:
1. ุงุฎุชุฑ ุงูุฃุฏูู ูู ุงููุงุฆูุฉ
2. ุงุถุบุท "ุฅุถุงูุฉ ุตูุงุญูุฉ"
3. ุญุฏุฏ ุงููุทุงู:
   - **ุงููุณู**: ูุญุฏุฏ ุฃู ุฌููุน ุงูุฃูุณุงู
   - **ุงูุณูุฉ**: ูุญุฏุฏุฉ ุฃู ุฌููุน ุงูุณููุงุช
   - **ุงูุชุฑู**: ูุญุฏุฏ ุฃู ุฌููุน ุงูุชุฑูุงุช
4. ุงุฎุชุฑ ุงูุตูุงุญูุงุช:
   - โ ุฅุฏุงุฑุฉ ุงูููุงุฏ
   - โ ุฅุฏุงุฑุฉ PDF
   - โ ุฅุฏุงุฑุฉ ุงูููุฏูู
   - โ ุฅุฏุงุฑุฉ ุงูุฌุฏุงูู
   - โ ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู
   - โ ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
   - โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
   - โ ุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ (ูุงุฏุฑุงู)
5. ุฃุถู ูุตู (ุงุฎุชูุงุฑู)
6. ุงุถุบุท "ุฅุถุงูุฉ ุงูุตูุงุญูุฉ"

### ุฃูุซูุฉ ุนูู ูุทุงูุงุช ุงูุตูุงุญูุงุช

#### ูุซุงู 1: ุฃุฏูู ูุณุคูู ุนู ูุณู ูุงูู
```
ุงููุณู: ุงูุฃูู ุงูุณูุจุฑุงูู
ุงูุณูุฉ: ุฌููุน ุงูุณููุงุช
ุงูุชุฑู: ุฌููุน ุงูุชุฑูุงุช
ุงูุตูุงุญูุงุช: ุฌููุน ุงูุตูุงุญูุงุช (ูุง ุนุฏุง ุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ)
```
**ุงููุตู**: "ูุณุคูู ูุณู ุงูุฃูู ุงูุณูุจุฑุงูู - ุตูุงุญูุงุช ูุงููุฉ"

#### ูุซุงู 2: ุฃุฏูู ูุณุคูู ุนู ุณูุฉ ูุญุฏุฏุฉ
```
ุงููุณู: ุงูุฐูุงุก ุงูุงุตุทูุงุนู
ุงูุณูุฉ: 2
ุงูุชุฑู: ุฌููุน ุงูุชุฑูุงุช
ุงูุตูุงุญูุงุช: ุฅุฏุงุฑุฉ ุงูููุงุฏุ PDFุ ุงูููุฏูู
```
**ุงููุตู**: "ูุณุคูู ุงูุณูุฉ ุงูุซุงููุฉ - ูุณู ุงูุฐูุงุก ุงูุงุตุทูุงุนู"

#### ูุซุงู 3: ุฃุฏูู ูุณุคูู ุนู ุชุฑู ูุญุฏุฏ ููุท
```
ุงููุณู: ุงูุจุฑูุงูุฌ ุงูุนุงู
ุงูุณูุฉ: 1
ุงูุชุฑู: ุงูุฃูู
ุงูุตูุงุญูุงุช: ุฅุฏุงุฑุฉ ุงูููุงุฏุ PDFุ ุงูุฌุฏุงูู
```
**ุงููุตู**: "ูุณุคูู ุงูุชุฑู ุงูุฃูู - ุงูุณูุฉ ุงูุฃููู - ุงูุจุฑูุงูุฌ ุงูุนุงู"

#### ูุซุงู 4: ุฃุฏูู ูุณุคูู ุนู ุงูุฑุณุงุฆู ููุท
```
ุงููุณู: ุฌููุน ุงูุฃูุณุงู
ุงูุณูุฉ: ุฌููุน ุงูุณููุงุช
ุงูุชุฑู: ุฌููุน ุงูุชุฑูุงุช
ุงูุตูุงุญูุงุช: ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู ููุท
```
**ุงููุตู**: "ูุณุคูู ุงูุฑุฏ ุนูู ุฑุณุงุฆู ุงูุทูุงุจ"

## ููููุฉ ุนูู ุงูุตูุงุญูุงุช

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
ุนูุฏูุง ูุญุงูู ุฃุฏูู ุงูููุงู ุจุนูููุฉุ ูุชู ุงูุชุญูู:

1. **ุฅุฐุง ูุงู Super Admin**: ุงูุณูุงุญ ุชููุงุฆูุงู โ
2. **ุฅุฐุง ูุงู Admin**: ุงูุชุญูู ูู ูุทุงูุงุช ุงูุตูุงุญูุงุช:
   - ูู ูุฏูู ุตูุงุญูุฉ ุงูุนูููุฉ ุงููุทููุจุฉุ
   - ูู ุงููุทุงู (ูุณูุ ุณูุฉุ ุชุฑู) ูุทุงุจูุ
   - ูู ุงูุตูุงุญูุฉ ูุดุทุฉุ

### ุฃููููุฉ ุงููุทุงูุงุช
ุงููุทุงู ุงูุฃูุณุน ูุดูู ุงูุฃุถูู:
- `ุฌููุน ุงูุฃูุณุงู` > `ูุณู ูุญุฏุฏ`
- `ุฌููุน ุงูุณููุงุช` > `ุณูุฉ ูุญุฏุฏุฉ`
- `ุฌููุน ุงูุชุฑูุงุช` > `ุชุฑู ูุญุฏุฏ`

**ูุซุงู**: ุฅุฐุง ูุงู ูุฏู ุฃุฏูู ุตูุงุญูุฉ "ุฌููุน ุงูุฃูุณุงู"ุ ููููู ุงูุชุนุฏูู ุนูู ุฃู ูุณู.

## ุงูุฃูุงู ูุงูุณุฌูุงุช

### ุณุฌู ุงูุชุบููุฑุงุช
ูู ุชุบููุฑ ูู ุงูุตูุงุญูุงุช ูุชู ุชุณุฌููู ูู `admin_scope_audit`:
- ูู ูุงู ุจุงูุชุบููุฑ
- ูุง ูู ุงูุชุบููุฑ
- ูุชู ุชู ุงูุชุบููุฑ
- ุงูุชูุงุตูู ุงููุงููุฉ (JSON)

### ุงููููุฏ ุงูุฃูููุฉ
1. ููุท Super Admin ููููู:
   - ุฅูุดุงุก ุฃุฏููุฒ ุฌุฏุฏ
   - ููุญ ุงูุตูุงุญูุงุช
   - ุชุนุฏูู ุงูุตูุงุญูุงุช
   - ุญุฐู ุงูุตูุงุญูุงุช
   - ุญุฐู ุงูุฃุฏููุฒ

2. ูุง ูููู ููุฃุฏูู:
   - ุชุนุฏูู ุตูุงุญูุงุชู ุงูุฎุงุตุฉ
   - ุฅุถุงูุฉ ุตูุงุญูุงุช ูููุณู
   - ุญุฐู Super Admin

## ุงุณุชุฎุฏุงู ูู ุงูููุฏ

### ูุซุงู 1: ุงูุชุญูู ูู ุตูุงุญูุฉ ุจุณูุทุฉ
```typescript
import { PermissionChecker } from '@/lib/permissionChecker';

const context = {
  userId: adminId,
  userRole: 'admin',
  department: 'Cyber Security',
  year: 2,
  term: 'FIRST'
};

const canEdit = await PermissionChecker.canManageMaterials(context);
if (!canEdit) {
  alert('ููุณ ูุฏูู ุตูุงุญูุฉ ูุชุนุฏูู ูุฐู ุงููุงุฏุฉ');
  return;
}
```

### ูุซุงู 2: ุงูุชุญูู ูู ุตูุงุญูุฉ ูุนูุตุฑ ูุนูู
```typescript
const canEditThisMaterial = await PermissionChecker.canManageItem(
  { userId: user.id, userRole: user.role },
  'materials',
  material.department,
  material.year,
  material.term
);
```

### ูุซุงู 3: ุงูุญุตูู ุนูู ุฌููุน ุงูุตูุงุญูุงุช
```typescript
const permissions = await PermissionChecker.getAllPermissions({
  userId: user.id,
  userRole: user.role
});

console.log(permissions);
// {
//   canManageMaterials: true,
//   canManagePdfs: true,
//   canManageVideos: false,
//   ...
// }
```

## ุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ

### ุชูุนูู/ุฅูุบุงุก ุชูุนูู ุฃุฏูู
- ุงุฎุชุฑ ุงูุฃุฏูู ูู ุงููุงุฆูุฉ
- ุงุถุบุท "ุฅูุบุงุก ุงูุชูุนูู" ุฃู "ุชูุนูู"
- ุณูููุน ุงูุฃุฏูู ุบูุฑ ุงููุดุท ูู ุชุณุฌูู ุงูุฏุฎูู

### ุญุฐู ุตูุงุญูุฉ
- ุงุฎุชุฑ ุงูุฃุฏูู
- ุงุถุบุท ๐๏ธ ุจุฌุงูุจ ุงูุตูุงุญูุฉ ุงููุฑุงุฏ ุญุฐููุง
- ุณูุชู ุญุฐู ุงูุตูุงุญูุฉ ููุฑุงู
- ูููู ุฅุถุงูุฉ ุตูุงุญูุฉ ุฌุฏูุฏุฉ ุจุฏูุงู ูููุง

### ุญุฐู ุฃุฏูู
- ุงุฎุชุฑ ุงูุฃุฏูู
- ุงุถุบุท "ุญุฐู"
- ุณูุชู ุญุฐู ุงูุฃุฏูู ูุฌููุน ุตูุงุญูุงุชู
- ูุง ูููู ุญุฐู Super Admin
- ูุง ูููู ุญุฐู ููุณู

## ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูุฃููุงู ูุงูุฃููููุงุช
- ๐ **ูุฏูุฑ ุฑุฆูุณู**: ุจููุณุฌู
- โก **ุฃุฏูู**: ุฃุฒุฑู
- โ **ูุดุท**: ุฃุฎุถุฑ
- โ **ุบูุฑ ูุดุท**: ุฃุญูุฑ

### ุงูุจุทุงูุงุช
ูู ุจุทุงูุฉ ุฃุฏูู ุชุนุฑุถ:
- ุงูุงุณู
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุงูุฏูุฑ (ูุฏูุฑ ุฑุฆูุณู / ุฃุฏูู)
- ุงูุญุงูุฉ (ูุดุท / ุบูุฑ ูุดุท)
- ุนุฏุฏ ูุทุงูุงุช ุงูุตูุงุญูุงุช

### ูุทุงูุงุช ุงูุตูุงุญูุงุช
ูู ูุทุงู ูุนุฑุถ:
- ุงููุณู / ุงูุณูุฉ / ุงูุชุฑู
- ุงููุตู
- ูุงุฆูุฉ ุงูุตูุงุญูุงุช ุงูููุนูุฉ
- ูู ููุญ ูุฐู ุงูุตูุงุญูุฉ
- ุฒุฑ ุงูุญุฐู

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: ูุง ูููู ุฑุคูุฉ ุชุจููุจ ุฅุฏุงุฑุฉ ุงูุฃุฏููุฒ
**ุงูุญู**: ุชุฃูุฏ ูู ุฃูู ูุณุฌู ุฏุฎูู ูู Super Admin ูููุณ Admin ุนุงุฏู

### ูุดููุฉ: ุฎุทุฃ ุนูุฏ ุฅูุดุงุก ุตูุงุญูุฉ
**ุงูุญู**: 
- ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุตูุงุญูุฉ ุจููุณ ุงููุทุงู ููุฃุฏูู
- ูุง ูููู ูุฌูุฏ ุตูุงุญูุชูู ุจููุณ (ุงููุณูุ ุงูุณูุฉุ ุงูุชุฑู) ูููุณ ุงูุฃุฏูู

### ูุดููุฉ: ุงูุฃุฏูู ูุง ูุฑู ุงูุจูุงูุงุช
**ุงูุญู**:
- ุชุฃูุฏ ูู ุฃู ุงูุฃุฏูู ูุฏูู ุตูุงุญูุฉ ููุนูุฉ
- ุชุฃูุฏ ูู ุฃู ุงููุทุงู ุตุญูุญ (ูุณูุ ุณูุฉุ ุชุฑู)
- ุฑุงุฌุน ุณุฌู ุงูุตูุงุญูุงุช

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุชูุตูุงุช ููุชุทููุฑ
1. **ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช**: ุฅุดุนุงุฑ ุงูุฃุฏูู ุนูุฏ ููุญู ุตูุงุญูุฉ ุฌุฏูุฏุฉ
2. **ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ**: ุชูุฑูุฑ ุจุตูุงุญูุงุช ุฌููุน ุงูุฃุฏููุฒ
3. **ุตูุงุญูุงุช ูุคูุชุฉ**: ุตูุงุญูุฉ ุชูุชูู ูู ุชุงุฑูุฎ ูุญุฏุฏ
4. **ูุณุฎ ุงูุตูุงุญูุงุช**: ูุณุฎ ุตูุงุญูุงุช ุฃุฏูู ูุฃุฏูู ุขุฎุฑ
5. **ููุงูุจ ุงูุตูุงุญูุงุช**: ููุงูุจ ุฌุงูุฒุฉ ููุฃุฏูุงุฑ ุงูุดุงุฆุนุฉ

### ุฃูุถู ุงูููุงุฑุณุงุช
1. ุงููุญ ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุตูุงุญูุงุช ุงููุทููุจุฉ
2. ุฑุงุฌุน ุงูุตูุงุญูุงุช ุฏูุฑูุงู
3. ุงุญุฐู ุงูุฃุฏููุฒ ุบูุฑ ุงููุณุชุฎุฏููู
4. ุงุณุชุฎุฏู ุฃูุตุงู ูุงุถุญุฉ ููุตูุงุญูุงุช
5. ุฑุงูุจ ุณุฌู ุงูุชุบููุฑุงุช

## ุงูุฏุนู

### ูููุณุงุนุฏุฉ
ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน ุณุฌู ุงูุตูุงุญูุงุช: `admin_scope_audit`
2. ุชุญูู ูู ุณุฌู ุงูุฃูุดุทุฉ: `user_activities`
3. ุงูุญุต console ุงููุชุตูุญ ููุฃุฎุทุงุก
4. ุฑุงุฌุน logs Supabase

### ูุนูููุงุช ูููุฉ
- **ุงูุฌุฏุงูู**: `admin_scopes`, `admin_scope_audit`
- **ุงูุฏูุงู**: `check_admin_permission`, `get_admin_scopes`, `get_all_admins_with_scopes`
- **ุงูุฎุฏูุงุช**: `AdminService`, `PermissionChecker`
- **ุงูุตูุญุงุช**: `/admin/manage-admins`

---

ุชู ุฅูุดุงุก ูุฐุง ุงููุธุงู ุจุนูุงูุฉ ูุถูุงู:
- โ ุงูุฃูุงู ุงููุงูู
- โ ุงููุฑููุฉ ูู ุงูุตูุงุญูุงุช
- โ ุณูููุฉ ุงูุงุณุชุฎุฏุงู
- โ ุงูุชูุณุน ุงููุณุชูุจูู
- โ ุงูุชุฏููู ุงููุงูู

ุงุณุชูุชุน ุจุฅุฏุงุฑุฉ ูุฑููู! ๐

